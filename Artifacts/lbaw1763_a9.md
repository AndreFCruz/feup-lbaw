# A9: Main accesses to the database and transactions

## 1. Main Accesses

> Main accesses to the database.

| SQL Reference | Access Description                          |
| ------------- | ------------------------------------------- |
| Web Resource  | Reference to the associated web resource(s) |
| `Complete SQL Code`                                         |

...

## 2. Transactions

> Transactions needed to assure the integrity of the data.

| T01 | Insert a question |
| --------------- | ----------------------------------- |
| Justification   | Since a object-oriented approach was used to map the question UML subclass to the relational model, atomicity must be guaranteed so all classes that need to be inserted are in fact all or none inserted. |
| Isolation level | Read Uncommitted |
```sql
BEGIN TRANSACTION;
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

DECLARE new_id INTEGER;
BEGIN;
INSERT INTO messages (author) VALUES ($author) RETURNING id INTO new_id;
INSERT INTO commentables (id) VALUES (new_id);
INSERT INTO questions (id, title) VALUES (new_id, $title);
INSERT INTO message_versions (content, message_id) values ($content, new_id);
END;

COMMIT;
```


***

GROUP1763, 22/04/2018

> André Cruz, up201503776@fe.up.pt  
> Daniel Marques, up201503822@fe.up.pt  
> Edgar Carneiro, up201503784@fe.up.pt  
> João Carvalho, up201504875@fe.up.pt  
